%\usepackage{etex} % Uncomment if shortage of latex registers.

% Silence certain warnings.
  \usepackage{silence} % http://33.media.tumblr.com/tumblr_ly63ddiYtu1r7uivno1_400.gif
  \WarningFilter{latex}{Marginpar on page} % Marginpar on page xx moved.
  \WarningFilter{tocstyle}{THIS IS AN ALPHA VERSION!}
  \WarningFilter{scrreprt}{\float@listhead detected!}

% Set up some variables.
  \usepackage{etoolbox}

  % Set to true for print version, false for screen reading version.
  % Screen reading version for example uses coloring of PDF links.
  \newtoggle{printversion}

% LaTeX and KOMA fixes.
  \usepackage{fixltx2e}
  \usepackage{fixmath}
  \usepackage{scrhack}

% Basic page layout.
  \KOMAoptions{
    paper=a4,
    twoside=true,
    open=right,
    %parskip=full, % To make space between paragraphs.
    fontsize=11pt,
    numbers=noenddot
  }
  % Margins.
  \usepackage{typearea}

  % Set binding correction area.
  \KOMAoptions{
    BCOR=10mm
    %DIV=9
  }

  % Headings.
  \usepackage[automark, headsepline=.3pt:head]{scrlayer-scrpage}
    \pagestyle{scrheadings}
    \ohead{{\MakeUppercase\leftmark}\rightmark}

    % Delete the number from sections.
    \renewcommand*{\sectionmarkformat}{:\enspace}
    \renewcommand*{\chaptermarkformat}{}

    % Font in header and footer.
    \setkomafont{pagehead}{\footnotesize\normalfont\sffamily}
    \setkomafont{pagenumber}{\footnotesize\normalfont\sffamily}

    % Line numbering.
    \usepackage{lineno}

% Language and fonts.
  % Encoding.
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}

  % Hyphenation.
  \usepackage[english]{babel}
  %\usepackage{hyphenat} % Allow already hyphenated words to be hyphenated.

  % Fonts.
  \usepackage[bitstream-charter]{mathdesign} % Serif font (Charter BT).
  \usepackage[scaled=0.84]{DejaVuSansMono} % Monospaced font.
  \def\sfdefault{SourceSansPro-TLF} % Sans serif font.

  % Typographic tweaks.
  \usepackage[babel]{microtype} % Enables kerning. Load after fonts.
  \usepackage{textcomp} % Uses the glyphs present in the fonts, rather than LaTeX workarounds for old fonts.

  % Parts style.
  \setkomafont{part}{\normalfont\Huge\fontseries{k}\sffamily\color{partcolor}}
  %\let\raggedpart\raggedright
  %\renewcommand*{\partpagestyle}{empty} % No page number on part page.

  % Chapters style.
  \setkomafont{chapter}{\normalfont\Huge\fontseries{k}\sffamily\color{chaptercolor}}
  % Spacing before chapter.
  \renewcommand{\chapterheadstartvskip}{\vspace*{1\baselineskip}}

  % Sections style.
  \setkomafont{section}{\normalfont\Large\fontseries{k}\sffamily\color{sectioning}}

  % Subsections style.
  \setkomafont{subsection}{\normalfont\large\fontseries{k}\sffamily\color{sectioning}}

  % Subsubsections style.
  \setkomafont{subsubsection}{\normalfont\normalsize\fontseries{k}\sffamily\color{sectioning}}

  % Section numbering in margin.
  %\renewcommand*{\othersectionlevelsformat}[3]{%
  %  \llap{#3\autodot\enskip}}

  % Lists and similar.
  \renewcommand{\descriptionlabel}[1]{\hspace{\labelsep}\color{descriptionlabeling}\sffamily{\textbf{#1}}}

  % Stretch arrays (in tabulars).
  \renewcommand{\arraystretch}{1.1}

% Maths
  \usepackage{amsmath}
  \usepackage{mathtools}
  \usepackage{siunitx}

% Floats
  % Grouping floats together.
  \usepackage{newfloat}
  \DeclareFloatingEnvironment{groupfloat}

  % Captions.
  %\KOMAoptions{captions=oneline}
  \KOMAoption{captions}{centeredbeside}
  \setcapindent{1em}
  \setkomafont{captionlabel}{\sffamily\color{sectioning}\bfseries}
  \setkomafont{caption}{\sffamily}

  % Subfigures
  \usepackage{subcaption}

% Graphics and colors.
  \usepackage{graphicx}
  \graphicspath{{graphics/}}

  \usepackage{xcolor}
    % Text colors.
    \definecolor{partcolor}{gray}{0.17}
    \definecolor{chaptercolor}{gray}{0.17}
    \definecolor{sectioning}{gray}{0.28}
    \definecolor{descriptionlabeling}{gray}{0.25}
    % Hyperlink colors.
    \definecolor{pdflinkcolor}{RGB}{36,42,158}
    \definecolor{urlcolor}{RGB}{133,52,52}

    % Box colors.
    \definecolor{clframe}{gray}{0.75}
    \definecolor{clshade}{gray}{0.95}

    % Graphs.
    \definecolor{color1}{cmyk}{100,50,0,0} % blue
    \definecolor{color2}{cmyk}{0,80,100,0} % vermillion
    \definecolor{color3}{cmyk}{97,0,75,0}  % blueish green
    \definecolor{color4}{cmyk}{10,70,0,0}  % reddish purple
    \definecolor{color5}{cmyk}{0,50,100,0} % orange

    % Code colors.
    \definecolor{javared}{rgb}{0.6,0,0}            % for strings
    \definecolor{javagreen}{rgb}{0.25,0.5,0.35}    % comments
    \definecolor{javapurple}{rgb}{0.6,0,0.5}       % keywords
    \definecolor{javadocblue}{rgb}{0.25,0.35,0.75} % javadoc

  \usepackage{tikz}
  \usepackage{pgfplots}
    \pgfplotsset{compat=1.10}
    \pgfplotsset{
      every axis label/.append style={font=\footnotesize},
      every axis/.append style={font=\scriptsize}
    }
  \usetikzlibrary{calc}
  \usetikzlibrary{arrows.meta}
  \usetikzlibrary{backgrounds}
  %\usepackage{tikz-qtree}
  \usetikzlibrary{decorations.pathmorphing}
  \usetikzlibrary{matrix,shapes,positioning}
  \usepgfplotslibrary{external}
  \tikzexternalize[prefix=graphics/tikz/]
  %\tikzexternaldisable % Disable by default

% Code and monospaced things.
  %\usepackage{algorithm}
  %\usepackage{algorithmic}
  \usepackage{listings}

  \lstdefinestyle{javastyle}{%
    language=Java,
    keywordstyle=\color{javapurple}\bfseries,
    stringstyle=\color{javared},
    commentstyle=\color{javagreen},
    morecomment=[s][\color{javadocblue}]{/**}{*/}
  }

  \lstnewenvironment{javacode}[1]{%
    \lstset{style=javastyle, #1}
  }{}

  \lstdefinelanguage{Groovy}[]{Java}{%
    keywordstyle=\color{javapurple}\bfseries,
    stringstyle=\color{javared}\ttfamily,
    keywords=[3]{each, findAll, groupBy, collect, inject, eachWithIndex},
    morekeywords={def, as, in, use},
    moredelim=[is][\textcolor{darkgray}]{\%\%}{\%\%},
    moredelim=[il][\textcolor{darkgray}]{§§}
  }

  \lstnewenvironment{gradlecode}[1][]{%
    \lstset{language=Groovy, #1}
  }{}

  \lstset{
    columns=flexible,
    escapechar=",
    escapeinside={(*@}{@*)},
    basicstyle=\ttfamily\footnotesize,
    frame=single, backgroundcolor=\color{clshade}, rulecolor=\color{clframe},
    framerule=\fboxrule, xleftmargin=3.4pt, xrightmargin=3.4pt, belowskip=\smallskipamount,
    captionpos=b,
    %numbers=left,
    %numberstyle=\scriptsize,
    %numbersep=7pt,
    tabsize=2,
    keepspaces=true,
    showspaces=false,
    showstringspaces=true,
    breaklines=true,
    breakatwhitespace=true,
    postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\color{red}\hookrightarrow\space}}
  }

% Tables
  \usepackage{booktabs} % Nicer typesetting of tables.
  \usepackage{multirow}
  \usepackage{supertabular}

% Lists
  \usepackage{enumerate}
  \usepackage[inline]{enumitem} % Customization of enumerate environments + inline lists.
  %\usepackage{paralist} % Inline lists and more.

% BibLaTex
  \usepackage[autostyle]{csquotes}
  \usepackage[
    backend=biber,
    citestyle=numeric-verb,
    bibstyle=numeric,
    hyperref=true,
    abbreviate=true,
    url=true,
  ]{biblatex}
  \addbibresource{references/references.bib}

 % Appendix
  \usepackage[titletoc]{appendix}

% PDF
  \usepackage{hyperref}
  \hypersetup{
    bookmarksnumbered,
    pdfauthor={sw609f15}, % PDF tag.
    pdftitle={PDF TITLE}, % PDF tag.
    pdfsubject={Student Report, Aalborg University},
    pdfpagelayout=TwoPageRight,
    pdfdisplaydoctitle,
    breaklinks,
    linktoc=all
    %plainpages=false
  }
  \iftoggle{printversion}{
    % Outputting PDF for printing
    \hypersetup{
      colorlinks,
      linkcolor=black,
      citecolor=black,
      urlcolor=black
    }
  }{
    % Outputting PDF for screen reading
    \hypersetup{
      colorlinks,
      linkcolor=pdflinkcolor,
      citecolor=pdflinkcolor,
      urlcolor=urlcolor
    }
  }
  \pdfminorversion=5
  \pdfobjcompresslevel=2
  \usepackage{pdfpages}
  \usepackage{bookmark}

% Comments/todos
  \usepackage{fixme}
    \fxsetup{
        status=draft,
        author={Todo},
        layout=inline,
				%marginclue,
        theme=color,
        silent=true
    }
  %\usepackage{todonotes}

% Misc.
  \usepackage{lastpage}
  \usepackage{multicol}
  \usepackage{xspace}
  \usepackage{dirtree}
% TOC.
  \usepackage{tocstyle} % MUST be loaded after pdfpages!
  \usetocstyle{KOMAlike}
  \setcounter{tocdepth}{1}
  \settocstylefeature{pagenumberhook}{\sffamily}
  \settocstylefeature{entryhook}{\sffamily}